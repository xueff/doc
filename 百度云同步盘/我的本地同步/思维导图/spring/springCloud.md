# springcloud基础知识

## 什么是微服

​	简 单 地 说 ， 微 服 务 是 系 统 架 构 上 的 一 种 设 计 风 格 ， 它 的 主 旨 是 将 一 个 原 本 独 立 的 系 统 

`拆 分` 成 多 个 `小 型 服 务` ， 这 些 小 型 服 务 都 在 各 自 独 立 的 进 程 中 运 行 ， 服 务 之 间 通 过 基 于 HTTP 的 RESTful API 进 行 `通 信 协 作` 。 被 拆 分 成 的 每 一 个 小 型 服 务 都 围 绕 着 系 统 中 的 某 一 项 或 一 些 耦 合 度 较 高 的 业 务 功 能 进 行 构 建 ， 并 且 每 个 服 务 都 维 护 着 自 身 的 数 据 存 储 、 业 务 开 发 、 自 动 化 测 试 案 例 以 及 独 立 部 署 机 制 。 由 于 有 了 轻 量 级 的 通 信 协 作 基 础 ， 所 以 这 些 微 服 务 可 以 使 用 `不 同 的 语 言` 来 编 写 。





## 与 单 体 系 统 的 区 别 

 	所 有 的 业 务 逻 辑 在 一 个 应 用 中 ， 开 发 、 测 试 、 部 署都 还 比 较 容 易 且 方 便 。 但 是 ， 随 着 企  的 发 展 ， 系 统 为 了 应 对 不 同 的 业 务 需 求 会 不 断 为 该 单 体 项 目 增 加 不 同 的 业 务 模 块 ； 同 时 随  移 动 端 设 备 的 进 步 ， 前 端 展 现 模 块 己 经 不 仅 仅 局 限 于 web 的 形 式 ， 这 对 于 系 统 后 端 向 前 端 的 支 持 需 要 更 多 的 接 口 模 块 。 单 体 应 用 由 于 面 对 的 业 务 需 求 更 为 宽 泛 ， 不 断 扩 大 的 需 求 会 使 得 单 体 应 用 变 得 越 来 越 `臃 肿 `。 单 体 应 用 的 问 题 . Spring Cloud 微 服 务 实 战 就 逐 渐 凸 显 出 来 ， 由 于 单 体 系 统 部 署 在 一 个 进 程 内 ， 往 往 我 们 修 改 了 一 个 很 小 的 功 能 · 为 了 部 署 上 线 会 `影 响 其 他 功 能 `的 运 行 。 并 且 ， 单 体 应 用 中 的 这 些 功 能 模 块 的 使 用 场 景 、 并 发 量 、 消 耗 的 资 源 类 型 都 各 有 不 同 ， 对 于 资 源 的 利 用 又 互 相 影 响 ， 这 样 使 得 我 们 对 各 个 业 务 模 块 的 系 统 容 量 很 难 给 出 较 为 准 确 的 评 估 。 所 以 ，` 单 体 系 统` 在 初 期 虽 然 可 以 非 常 方 便 地 进 行 开 发 和 使 用 ， 但 是 随 着 系 统 的 发 展 ，` 维 护 成 本` 会 变 得 越 来 越 大 ， 且 难 以 控 制 。  

​	为 了 解 决 单 体 系 统 变 得 庞 大 臃 肿 之 后 产 生 的 难 以 维 护 的 问 题 ， 微 服 务 架 构 诞 生 了 并 被 
大 家 所 关 注 。 我 们 将 系 统 中 的 不 同 功 能 `模 块 拆 分` 成 多 个 不 同 的 服 务 ， 这 些 服 务 都 能 够 独 立 部 署 和 扩 展 。 由 于 每 个 服 务 都 运 行 在 自 己 的 进 程 内 ， 在 部 署 上 有 稳 固 的 边 界 ， 这 样 每 个 服 
务 的 更 新 都 不 会 影 响 其 他 服 务 的 运 行 。 同 时 ， 由 于 是 独 立 部 署 的 ， 我 们 可 以 更 准 确 地 为 每 
个 服 务 评 估 性 能 容 量 ， 通 过 配 合 服 务 间 的 协 作 流 程 也 可 以 更 容 易 地 发 现 系 统 的 瓶 颈 位 置 ， 
以 及 给 出 较 为 准 确 的 系 统 级 性 能 容 量 评 估 。 





## 微服服务调用2种方式

有 两 种 服 务 调 用 方 式 ： 
第 一 种 ， 使 用 `HTTP` 的 RESTfuI API 或 轻 量 级 的 消 息 发 送 协 议 ， 实 现 信 息 传 递 与 服 务 调 用 的 触 发 。 
第 二 种 ， 通 过 在 轻 量 级` 消 息 总 线` 上 传 递 消 息 ， 类 似 RabbitMQ 等 一 些 提 供 可 靠 异 步 交 换 的 中 间 件 。 



## 去中心化数据（数据库去中心化）

计算机生成了可选文字:
去 中 心 化 管 理 数 据 时，我 们 在 实 施 微 服 务 架 构 时 ， 都 希 望 让 每 一 个 服 务 来 管 理 其` 自 有 的 数 据 库` ， 这 就 是 数 据 管 理 的 去 中 心 化 。 
①：可以将 原 数 据 库 中 的 存 储 内 容 拆 分 到 新 的 同 平 台 的 其 他 数 据 库 实 例 中 之 外 （ 如 把 原 本 存 储 在 MySQL 中 的 表 拆 分 后 ， 存 储 到 多 个 不 同 的 MySQL 实 例 中 ） ， 
②：也 可 以 将 一 些 具 有 特 殊 结 构 或 业 务 特 性 的 数 据 存 储 到 一 些 其 他 技 术 的 数 据 库 实 例 中 （ 如 把 日 志 信 息 存 储 到 MongoDB 中 或 把 用 户 登 录 信 息 存 储 到 Redis 中 ） 。 

###  

#### 产生问题

数 据 一 致 性 也 成 为 微 服 务 架 构 中 亟 待 解 决 的 问 题 之 一 。 分 布 式 事 务 本 身 的 实 现 难 度 就 非 常 大 ， 所 以 在 微 服 务 架 构 中 ， 我 们 更 强 调 在 各 服 务 之 间 进 行` “ 无 事 务 ”` 的 调 用 ， 而 对 于 数 据 一 致 性 ， 只 要 求 数 据 在 `最 后 的 处 理 状 态 是 一 致` 的 即 可 ： 若 在 过 程 中 发 现 错 误 ， 通 过 `补 偿 机 制` 来 进 行 处 理 ， 使 得 错 误 数 据 能 够 达 到` 最 终 的 一 致 性` 。 



##容 错 设 计 

​	在 微 服 务 架 构 中 ， 由 于 服 务 都 运 行 在 独 立 的 进 程 中 ， 所 以 存 在 部 分 服 务 出 现 故 障 ，而 其 他 服 务 正 常 运 行 的 情 况 。 比 如 ， 当 正 常 运 作 的 服 务 B 调 用 到 故 障 服 务 A 时 ， 因 `故 障 服 务 A `没 有 返 回 ， 线 程 `挂 起` 开 始 等 待 ， 直 到 超 时 才 能 释 放 ， 而 此 时 若 触 发 服 务 B 调 用 服 务 A 的 `请 求 来 自 服 务 C `， 而 服 务 c 频 繁 调 用 服 务 B 时 ， 由 于 其 依 赖 服 务 A ， 大 量` 线 程 被 挂 `起 等 待 ， 最 后 导 致 服 务 A 也 不 能 正 常 服 务 ， 这 时 就 会 出 现 故 障 的 蔓 延 。

 所 以 ， 在 微 服 务 架 构 中 ， 快 速 检 测 出 故 障 源 并 尽 可 能 地 自 动 恢 复 服 务 是 必 须 被 设 计 和 . Spring Cloud 微 服 务 实 战 考 虑 的 。 通 常 ， 我 们 都 希 望 在 每 个 服 务 中 实 现 监 控 和 日 志 记 录 的 组 件 ， 路 器 状 态 、 吞 吐 量 、 网 络 延 迟 等 关 键 数 据 的 仪 表 盘 等 。 
比 如 服 务 状 态 、 
断 